<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Depot Notes — Simple / Pro + GPT</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root { --gap: .75rem; --pad: .75rem; --br: 8px; --muted:#667085; }
  html,body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; background:#f7f7f9; color:#111; }
  header { background:#0e1217; color:#fff; padding:1rem 1.25rem; display:flex; gap:1rem; align-items:center; flex-wrap:wrap; }
  header h1 { font-size:1.05rem; margin:0; white-space:nowrap; }
  .tag { background:#212632; color:#b6c0d1; padding:.15rem .5rem; border-radius:999px; font-size:.8rem; }
  .wrap { padding:1rem; max-width:1100px; margin:0 auto; }
  .toolbar { display:flex; gap:.75rem; align-items:center; background:#fff; border:1px solid #e6e7eb; padding:.5rem; border-radius:var(--br); }
  .toolbar .spacer { flex:1; }
  .toolbar label { display:inline-flex; align-items:center; gap:.35rem; font-weight:600; }
  .toolbar input[type="radio"] { transform:translateY(1px); }
  .small { font-size:.85rem; color:var(--muted); }
  .row { display:flex; gap:1rem; margin-top:1rem; }
  .col { background:#fff; border:1px solid #e6e7eb; border-radius:var(--br); padding:var(--pad); flex:1; min-width:0; }
  .col.narrow { flex:0 0 300px; }
  select, input[type="text"], textarea { width:100%; padding:.5rem .6rem; border:1px solid #d6d7db; border-radius:6px; font:inherit; }
  button { padding:.55rem .75rem; border:1px solid #d6d7db; border-radius:6px; background:#fff; cursor:pointer; }
  button.primary { background:#0e1217; color:#fff; border-color:#0e1217; }
  button:disabled { opacity:.5; cursor:not-allowed; }
  .section-head { display:flex; align-items:center; gap:.5rem; margin-bottom:.5rem; }
  .grid { display:grid; gap:.5rem; }
  .grid2 { display:grid; grid-template-columns:1fr 1fr; gap:.5rem; }
  .list { border:1px solid #e6e7eb; border-radius:6px; max-height:340px; overflow:auto; padding:.25rem; }
  .item { display:flex; align-items:center; gap:.5rem; padding:.3rem .4rem; border-radius:6px; }
  .item:hover { background:#f2f3f7; }
  .muted { color:var(--muted); font-size:.9rem; }
  .section-actions { display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.5rem; }
  .copy-box { margin-top:1rem; display:grid; gap:.5rem; }
  .pill { font-size:.75rem; padding:.15rem .5rem; border:1px solid #d6d7db; border-radius:999px; background:#fafafe; }
  .hidden { display:none !important; }
  .note { color:#b54708; font-weight:600; }
  .ok { color:#067647; font-weight:600; }
  .danger { color:#b42318; font-weight:600; }
  .hr { height:1px; background:#ececf1; margin:.5rem 0; }
</style>
</head>
<body>
<header>
  <h1>Depot Notes</h1>
  <span class="tag">Simple / Pro</span>
  <span class="small">Tick → Copy → Paste. Attach from any category in both views. GPT summaries included.</span>
</header>

<div class="wrap">

  <!-- Top toolbar -->
  <div class="toolbar" role="region" aria-label="Toolbar">
    <label><input type="radio" name="viewMode" value="simple" checked> Simple</label>
    <label><input type="radio" name="viewMode" value="pro"> Pro</label>

    <div class="spacer"></div>

    <!-- GPT controls -->
    <label class="small">CF Worker URL</label>
    <input id="gptUrl" type="text" placeholder="https://your-worker.workers.dev/api/gpt" style="max-width:460px">
    <button id="btnSummariseDepot" class="primary" title="Depot-ready semicolon notes">Summarise (Depot)</button>
    <button id="btnSummariseCustomer" title="Customer-facing bullets">Summarise (Customer)</button>
  </div>

  <!-- Main row -->
  <div class="row">
    <!-- LEFT: Section & Simple view -->
    <div class="col narrow">
      <div class="section-head">
        <strong>Section</strong>
        <span class="muted">Choose a Depot section</span>
      </div>
      <select id="sectionSelect"></select>

      <div id="simplePane" class="grid" style="margin-top:.75rem">
        <div class="muted">Tick items below (from current section category). Add a quick note. Attach from any other category if needed.</div>
        <div id="simpleList" class="list" role="listbox" aria-label="Simple tick list"></div>

        <label><strong>Notes (one-liner optional)</strong></label>
        <textarea id="simpleNote" rows="3" placeholder="e.g., Raise boiler 60mm for clearance; paint flue plate."></textarea>

        <div class="grid2">
          <select id="attachFromCategorySimple">
            <option value="">+ Attach items from another category…</option>
          </select>
          <button id="btnAttachSimple" disabled>Attach</button>
        </div>

        <div class="section-actions">
          <button id="btnCopySection" class="primary">Copy Section</button>
          <button id="btnSummariseSection">Summarise Section</button>
          <span id="simpleCount" class="pill">0 selected</span>
        </div>
      </div>

      <div id="proPane" class="grid hidden" style="margin-top:.75rem">
        <div class="muted">Pro picker: search + add from any category; multi-select; same copy logic.</div>
        <input id="proSearch" type="text" placeholder="Search text or code (live filter)">
        <div class="grid2">
          <select id="proCategory">
            <option value="">All categories</option>
          </select>
          <button id="btnAddVisible">Add visible</button>
        </div>
        <div id="proList" class="list" role="listbox" aria-label="Pro list"></div>
        <div class="section-actions">
          <button id="btnCopySectionPro" class="primary">Copy Section</button>
          <button id="btnSummariseSectionPro">Summarise Section</button>
          <span id="proCount" class="pill">0 selected</span>
        </div>
      </div>
    </div>

    <!-- RIGHT: Output -->
    <div class="col">
      <div class="section-head">
        <strong>Copy Box Output</strong>
        <span class="muted">Semicolon lines; grouped by section if you include headers</span>
      </div>
      <div class="grid2">
        <label class="small"><input id="includeHeaders" type="checkbox" checked> Include section headers</label>
        <label class="small"><input id="sortLines" type="checkbox" checked> Sort lines (stable)</label>
      </div>
      <textarea id="copyOutput" rows="16" readonly></textarea>
      <div class="section-actions">
        <button id="btnCopyToClipboard" class="primary">Copy</button>
        <span id="status" class="small muted"></span>
      </div>

      <div class="hr"></div>
      <details>
        <summary><strong>What gets copied?</strong></summary>
        <p class="small">We copy (1) optional <span class="pill">NOTE; …</span> then (2) all selected <span class="pill">CODE; text</span> lines. Attach lets you pull items from any category into the active section.</p>
      </details>
    </div>
  </div>
</div>

<script defer src="update.js"></script>
</body>
</html>